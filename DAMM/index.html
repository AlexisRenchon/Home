<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   <link rel="stylesheet" href="/TEST/libs/highlight/github.min.css">
   
  <link rel="stylesheet" href="/TEST/css/franklin.css">
<link rel="stylesheet" href="/TEST/css/pure.css">
<link rel="stylesheet" href="/TEST/css/side-menu.css">
<!-- style adjustments -->
<style>
.franklin-content{padding-left:10%;}
@media (min-width: 940px) {
  .franklin-content {width: 640px; margin-left: 0px; padding-left: 80px;}
  .header {width: 700px;}
}
</style>
<link rel="icon" href="/TEST/assets/favicon.png">

   <title>WGLMakie + JSServe</title>  
</head>
<body>
  <div id="layout">
    <!-- Menu toggle / hamburger icon -->
    <a href="#menu" id="menuLink" class="menu-link"><span></span></a>
    <div id="menu">
      <div class="pure-menu">
        <a class="pure-menu-heading" href="#">CUP of TEA</a>
        <ul class="pure-menu-list">
          <li class="pure-menu-item "><a href="/TEST/" class="pure-menu-link">Home</a></li>
          <li class="pure-menu-item "><a href="/TEST/menu1/" class="pure-menu-link">Interactive viz</a></li>
          <li class="pure-menu-item "><a href="/TEST/menu2/" class="pure-menu-link">Data analysis</a></li>
          <li class="pure-menu-item "><a href="/TEST/menu3/" class="pure-menu-link">Data standard</a></li>
		  <li class="pure-menu-item "><a href="/TEST/menu4/" class="pure-menu-link">Exp design</a></li>
        </ul>
      </div>
    </div>
    <div id="main"> <!-- Closed in foot -->
      <div class="header">
        <h1>WGLMakie + JSServe</h1>
        <h2>Argonne National Laboratory, EVS</h2>
      </div>


<!-- Content appended here -->
<div class="franklin-content">
<pre><code class="language-julia">using WGLMakie, JSServe, UnicodeFun, SparseArrays, Observables
io &#61; IOBuffer&#40;&#41;
println&#40;io, &quot;~~~&quot;&#41;
show&#40;io, MIME&quot;text/html&quot;&#40;&#41;, Page&#40;exportable&#61;true, offline&#61;true&#41;&#41;

# load DAMM, 3 params &#43; porosity
include&#40;&quot;DAMM_scaled_porosity.jl&quot;&#41;;
L &#61; 40 # resolution
x &#61; collect&#40;range&#40;1, length&#61;L, stop&#61;1&#41;&#41;
&#91;append&#33;&#40;x, collect&#40;range&#40;i, length&#61;L, stop&#61;i&#41;&#41;&#41; for i &#61; 2:40&#93;
x &#61; reduce&#40;vcat,x&#41;
y &#61; collect&#40;range&#40;0.0, length&#61;L, stop&#61;0.70&#41;&#41;
y &#61; repeat&#40;y, outer&#61;L&#41;
x_range &#61; hcat&#40;x, y&#41;
x &#61; Int.&#40;x_range&#91;:, 1&#93;&#41;
y_ax &#61; collect&#40;range&#40;0.0, length&#61;L, stop&#61;0.70&#41;&#41;
y &#61; collect&#40;range&#40;1, length&#61;L, stop&#61;L&#41;&#41;
y &#61; repeat&#40;y, outer&#61;L&#41;
y &#61; Int.&#40;y&#41;
x_ax &#61; collect&#40;range&#40;1, length&#61;L, stop&#61;L&#41;&#41;

function create_plot&#40;sliders1, sliders2, sliders3, sliders4&#41;
	fig &#61; Figure&#40;resolution &#61; &#40;1800, 1000&#41;&#41;
	ax3D &#61; Axis3&#40;fig&#91;1,1&#93;&#41;
	surface&#33;&#40;ax3D, x_ax, y_ax, lift&#40;&#40;AlphaSx, kMSx, kMO2, Porosity&#41;-&gt;
		Matrix&#40;sparse&#40;x, y, DAMM&#40;x_range, &#91;AlphaSx, kMSx, kMO2, Porosity&#93;&#41;&#41;&#41;,
		sliders1.value, sliders2.value, sliders3.value, sliders4.value&#41;,
		colormap &#61; Reverse&#40;:Spectral&#41;, transparency &#61; true, alpha &#61; 0.2, shading &#61; false&#41; 

	wireframe&#33;&#40;ax3D, x_ax, y_ax, lift&#40;&#40;AlphaSx, kMSx, kMO2, Porosity&#41;-&gt;
		Matrix&#40;sparse&#40;x, y, DAMM&#40;x_range, &#91;AlphaSx, kMSx, kMO2, Porosity&#93;&#41;&#41;&#41;,
		sliders1.value, sliders2.value, sliders3.value, sliders4.value&#41;,
		   overdraw &#61; true, transparency &#61; true, color &#61; &#40;:black, 0.1&#41;&#41;;

	ax3D.xlabel &#61; to_latex&#40;&quot;T_&#123;soil&#125; &#40;Â°C&#41;&quot;&#41;;
	ax3D.ylabel &#61; to_latex&#40;&quot;\\theta &#40;m^3 m^&#123;-3&#125;&#41;&quot;&#41;;
	ax3D.zlabel &#61; to_latex&#40;&quot;R_&#123;soil&#125; &#40;\\mumol m^&#123;-2&#125; s^&#123;-1&#125;&#41;&quot;&#41;;
	zlims&#33;&#40;0, 25&#41;
	ylims&#33;&#40;0, 0.7&#41;
	return fig
end

sr &#61; &#91;0.1:0.1:1, # alpha
	0:1:50, # kMsx
	0:1:50, # kmo2
	0.2:0.05:0.7&#93;; # porosity


app &#61; App&#40;&#41; do session::Session    
	sliders1 &#61; JSServe.Slider&#40;sr&#91;1&#93;&#41;
	sliders2 &#61; JSServe.Slider&#40;sr&#91;2&#93;&#41;
	sliders3 &#61; JSServe.Slider&#40;sr&#91;3&#93;&#41;
	sliders4 &#61; JSServe.Slider&#40;sr&#91;4&#93;&#41;
	fig &#61; create_plot&#40;sliders1, sliders2, sliders3, sliders4&#41;    
    	slider1 &#61; DOM.div&#40;&quot;alpha: &quot;, sliders1, sliders1.value&#41;
	slider2 &#61; DOM.div&#40;&quot;kMsx: &quot;, sliders2, sliders2.value&#41;
	slider3 &#61; DOM.div&#40;&quot;kMO2: &quot;, sliders3, sliders3.value&#41;
	slider4 &#61; DOM.div&#40;&quot;porosity: &quot;, sliders4, sliders4.value&#41;
    	return JSServe.record_states&#40;session, DOM.div&#40;slider1, slider2, slider3, slider4, fig&#41;&#41;
end


show&#40;io, MIME&quot;text/html&quot;&#40;&#41;, app&#41;
println&#40;io, &quot;~~~&quot;&#41;
println&#40;String&#40;take&#33;&#40;io&#41;&#41;&#41;</code></pre>
Invalid aspect &#40;1, 1, 0.6666666666666666&#41;
<div class="page-foot">
  <div class="copyright">
    &copy; Dr. Alexandre A. Renchon. Last modified: September 24, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
      </div> <!-- end of id=main -->
  </div> <!-- end of id=layout -->
  <script src="/TEST/libs/pure/ui.min.js"></script>
  
  
      <script src="/TEST/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

  
</body>
</html>
